FUNCTION "sales_fuzzy_search" (query NVARCHAR(80 ))
	RETURNS table ("SCORE" INT,"CURRENCY" NVARCHAR(5),"GROSSAMOUNT" DECIMAL(15,2),"SALESORDERID" NVARCHAR(10),"TAXAMOUNT" DECIMAL(15,2),"CITY" VARCHAR(40),"COMPANYNAME" NVARCHAR(80),"PARTNERID" NVARCHAR(10)) 
	LANGUAGE SQLSCRIPT 
	SQL SECURITY INVOKER AS 
BEGIN 
RETURN SELECT * FROM ((select TO_INT(SCORE()*100)/100 AS SCORE, "CURRENCY","GROSSAMOUNT","SALESORDERID", "TAXAMOUNT", "CITY", TO_NVARCHAR(COMPANYNAME) AS COMPANYNAME, "PARTNERID" FROM "sap.hana.democontent.epm.models::SALES_ORDER_HEADER_W_BUYER"
WHERE CONTAINS("COMPANYNAME",:query,FUZZY( 0.7 , 'similarCalculationMode=symmetricsearch')) ORDER BY score DESC) UNION ALL (SELECT TO_INT(SCORE()*100)/100 AS SCORE, "CURRENCY","GROSSAMOUNT","SALESORDERID", "TAXAMOUNT", TO_NVARCHAR(CITY) AS CITY, "COMPANYNAME" AS COMPANYNAME, "PARTNERID" FROM "sap.hana.democontent.epm.models::SALES_ORDER_HEADER_W_BUYER"
WHERE CONTAINS("CITY",:query,FUZZY( 0.7 , 'similarCalculationMode=symmetricsearch')) ORDER BY score DESC)) ORDER BY score DESC ;
END;